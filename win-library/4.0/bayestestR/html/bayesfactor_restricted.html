<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Bayes Factors (BF) for Order Restricted Models</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for bayesfactor_restricted {bayestestR}"><tr><td>bayesfactor_restricted {bayestestR}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Bayes Factors (BF) for Order Restricted Models</h2>

<h3>Description</h3>

<p>This method computes Bayes factors for comparing a model with an order restrictions on its parameters
with the fully unrestricted model. <em>Note that this method should only be used for confirmatory analyses</em>.
<br /> <br />
The <code>bf_*</code> function is an alias of the main function.
<br /> <br />
<strong>For more info, in particular on specifying correct priors for factors with more than 2 levels, see <a href="https://easystats.github.io/bayestestR/articles/bayes_factors.html">the Bayes factors vignette</a>.</strong>
</p>


<h3>Usage</h3>

<pre>
bayesfactor_restricted(
  posterior,
  hypothesis,
  prior = NULL,
  verbose = TRUE,
  ...
)

bf_restricted(posterior, hypothesis, prior = NULL, verbose = TRUE, ...)

## S3 method for class 'stanreg'
bayesfactor_restricted(
  posterior,
  hypothesis,
  prior = NULL,
  verbose = TRUE,
  effects = c("fixed", "random", "all"),
  component = c("conditional", "zi", "zero_inflated", "all"),
  ...
)

## S3 method for class 'brmsfit'
bayesfactor_restricted(
  posterior,
  hypothesis,
  prior = NULL,
  verbose = TRUE,
  effects = c("fixed", "random", "all"),
  component = c("conditional", "zi", "zero_inflated", "all"),
  ...
)

## S3 method for class 'emmGrid'
bayesfactor_restricted(
  posterior,
  hypothesis,
  prior = NULL,
  verbose = TRUE,
  ...
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>posterior</code></td>
<td>
<p>A <code>stanreg</code> / <code>brmsfit</code> object, <code>emmGrid</code> or a data frame - representing a posterior distribution(s) from (see Details).</p>
</td></tr>
<tr valign="top"><td><code>hypothesis</code></td>
<td>
<p>A character vector specifying the restrictions as logical conditions (see examples below).</p>
</td></tr>
<tr valign="top"><td><code>prior</code></td>
<td>
<p>An object representing a prior distribution (see Details).</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>Toggle off warnings.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr valign="top"><td><code>effects</code></td>
<td>
<p>Should results for fixed effects, random effects or both be returned?
Only applies to mixed models. May be abbreviated.</p>
</td></tr>
<tr valign="top"><td><code>component</code></td>
<td>
<p>Should results for all parameters, parameters for the conditional model
or the zero-inflated part of the model be returned? May be abbreviated. Only
applies to <span class="pkg">brms</span>-models.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is used to compute Bayes factors for order-restricted models vs un-restricted
models by setting an order restriction on the prior and posterior distributions
(<cite>Morey &amp; Wagenmakers, 2013</cite>).
<br /><br />
(Though it is possible to use <code>bayesfactor_restricted()</code> to test interval restrictions,
it is more suitable for testing order restrictions; see examples).
<br /><br />
For the computation of Bayes factors, the model priors must be proper priors (at the very least
they should be <em>not flat</em>, and it is preferable that they be <em>informative</em>); As the priors for
the alternative get wider, the likelihood of the null value(s) increases, to the extreme that for completely
flat priors the null is infinitely more favorable than the alternative (this is called <em>the Jeffreys-Lindley-Bartlett
paradox</em>). Thus, you should only ever try (or want) to compute a Bayes factor when you have an informed prior.
<br /><br />
(Note that by default, <code>brms::brm()</code> uses flat priors for fixed-effects.)
</p>


<h4>Setting the correct <code>prior</code></h4>

<p>It is important to provide the correct <code>prior</code> for meaningful results.
</p>

<ul>
<li><p> When <code>posterior</code> is a <code>data.frame</code>, <code>prior</code> should also be a <code>data.frame</code>, with matching column order.
</p>
</li>
<li><p> When <code>posterior</code> is a <code>stanreg</code> or <code>brmsfit</code> model: </p>

<ul>
<li> <p><code>prior</code> can be set to <code>NULL</code>, in which case prior samples are drawn internally.
</p>
</li>
<li> <p><code>prior</code> can also be a model equvilant to <code>posterior</code> but with samples from the priors <em>only</em>.
</p>
</li></ul>

</li>
<li><p> When <code>posterior</code> is an <code>emmGrid</code> object: </p>

<ul>
<li> <p><code>prior</code> should be the <code>stanreg</code> or <code>brmsfit</code> model used to create the <code>emmGrid</code> objects.
</p>
</li>
<li> <p><code>prior</code> can also be an <code>emmGrid</code> object equvilant to <code>posterior</code> but created with a model of priors samples <em>only</em>.
</p>
</li>
<li> <p><strong>Note:</strong> When the <code>emmGrid</code> has undergone any transformations (<code>"log"</code>, <code>"response"</code>, etc.), or <code>regrid</code>ing, then <code>prior</code> must be an <code>emmGrid</code> object, as stated above.
</p>
</li></ul>

</li></ul>



<h4>Interpreting Bayes Factors</h4>

<p>A Bayes factor greater than 1 can be interpereted as evidence against the null,
at which one convention is that a Bayes factor greater than 3 can be considered
as &quot;substantial&quot; evidence against the null (and vice versa, a Bayes factor
smaller than 1/3 indicates substantial evidence in favor of the null-hypothesis)
(<cite>Wetzels et al. 2011</cite>).
</p>



<h3>Value</h3>

<p>A data frame containing the Bayes factor representing evidence <em>against</em> the un-restricted model.
</p>


<h3>References</h3>


<ul>
<li><p> Morey, R. D., &amp; Wagenmakers, E. J. (2014). Simple relation between Bayesian order-restricted and point-null hypothesis tests. Statistics &amp; Probability Letters, 92, 121-124.
</p>
</li>
<li><p> Morey, R. D., &amp; Rouder, J. N. (2011). Bayes factor approaches for testing interval null hypotheses. Psychological methods, 16(4), 406.
</p>
</li>
<li><p> Morey, R. D. (Jan, 2015). Multiple Comparisons with BayesFactor, Part 2 â€“ order restrictions. Retrived from https://richarddmorey.org/category/order-restrictions/.
</p>
</li></ul>



<h3>Examples</h3>

<pre>
library(bayestestR)
prior &lt;- data.frame(
  X = rnorm(100),
  X1 = rnorm(100),
  X3 = rnorm(100)
)

posterior &lt;- data.frame(
  X = rnorm(100, .4),
  X1 = rnorm(100, -.2),
  X3 = rnorm(100)
)

hyps &lt;- c(
  "X &gt; X1 &amp; X1 &gt; X3",
  "X &gt; X1"
)

bayesfactor_restricted(posterior, hypothesis = hyps, prior = prior)
## Not run: 
# rstanarm models
# ---------------
if (require("rstanarm") &amp;&amp; require("emmeans")) {
  fit_stan &lt;- stan_glm(mpg ~ wt + cyl + am,
    data = mtcars
  )
  hyps &lt;- c(
    "am &gt; 0 &amp; cyl &lt; 0",
    "cyl &lt; 0",
    "wt - cyl &gt; 0"
  )
  bayesfactor_restricted(fit_stan, hypothesis = hyps)

# emmGrid objects
# ---------------
# replicating http://bayesfactor.blogspot.com/2015/01/multiple-comparisons-with-bayesfactor-2.html
  disgust_data &lt;- read.table(url("http://www.learnbayes.org/disgust_example.txt"), header = TRUE)

  contrasts(disgust_data$condition) &lt;- contr.bayes # see vignette
  fit_model &lt;- stan_glm(score ~ condition, data = disgust_data, family = gaussian())

  em_condition &lt;- emmeans(fit_model, ~condition)
  hyps &lt;- c("lemon &lt; control &amp; control &lt; sulfur")

  bayesfactor_restricted(em_condition, prior = fit_model, hypothesis = hyps)
# &gt; # Bayes Factor (Order-Restriction)
# &gt;
# &gt;                          Hypothesis P(Prior) P(Posterior) Bayes Factor
# &gt;  lemon &lt; control &amp; control &lt; sulfur     0.17         0.75         4.49
# &gt; ---
# &gt; Bayes factors for the restricted model vs. the un-restricted model.
}

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>bayestestR</em> version 0.7.0 <a href="00Index.html">Index</a>]</div>
</body></html>
