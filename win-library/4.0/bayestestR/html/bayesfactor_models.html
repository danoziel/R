<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Bayes Factors (BF) for model comparison</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for bayesfactor_models {bayestestR}"><tr><td>bayesfactor_models {bayestestR}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Bayes Factors (BF) for model comparison</h2>

<h3>Description</h3>

<p>This function computes or extracts Bayes factors from fitted models.
<br /> <br />
The <code>bf_*</code> function is an alias of the main function.
</p>


<h3>Usage</h3>

<pre>
bayesfactor_models(..., denominator = 1, verbose = TRUE)

bf_models(..., denominator = 1, verbose = TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>...</code></td>
<td>
<p>Fitted models (see details), all fit on the same data, or a single <code>BFBayesFactor</code> object (see 'Details').</p>
</td></tr>
<tr valign="top"><td><code>denominator</code></td>
<td>
<p>Either an integer indicating which of the models to use as the denominator,
or a model to be used as a denominator. Ignored for <code>BFBayesFactor</code>.</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>Toggle off warnings.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the passed models are supported by <span class="pkg">insight</span> the DV of all models will be tested for equality
(else this is assumed to be true), and the models' terms will be extracted (allowing for follow-up
analysis with <code>bayesfactor_inclusion</code>).
</p>

<ul>
<li><p> For <code>brmsfit</code> or <code>stanreg</code> models, Bayes factors are computed using the <a href="https://CRAN.R-project.org/package=bridgesampling"><span class="pkg">bridgesampling</span></a> package.
</p>

<ul>
<li> <p><code>brmsfit</code> models must have been fitted with <code>save_all_pars = TRUE</code>.
</p>
</li>
<li> <p><code>stanreg</code> models must have been fitted with a defined <code>diagnostic_file</code>.
</p>
</li></ul>

</li>
<li><p> For <code>BFBayesFactor</code>, <code>bayesfactor_models()</code> is mostly a wraparoud <code>BayesFactor::extractBF()</code>.
</p>
</li>
<li><p> For all other model types (supported by <a href="https://CRAN.R-project.org/package=insight"><span class="pkg">insight</span></a>), BIC approximations are used to compute Bayes factors.
</p>
</li></ul>

<p>In order to correctly and precisely estimate Bayes factors, a rule of thumb are
the 4 P's: <strong>P</strong>roper <strong>P</strong>riors and <strong>P</strong>lentiful <strong>P</strong>osterior
(i.e. probably at leat 40,000 samples instead of the default of 4,000).
<br /> <br />
A Bayes factor greater than 1 can be interpereted as evidence against the compared-to
model (the denominator). One convention is that a Bayes factor greater than 3 can be considered
as &quot;substantial&quot; evidence against the denominator model (and vice versa, a Bayes factor
smaller than 1/3 indicates substantial evidence in favor of the denominator model)
(<cite>Wetzels et al. 2011</cite>).
<br /> <br />
See also <a href="https://easystats.github.io/bayestestR/articles/bayes_factors.html">the Bayes factors vignette</a>.
</p>


<h3>Value</h3>

<p>A data frame containing the models' formulas (reconstructed fixed and random effects) and their BFs, that prints nicely.
</p>


<h3>Note</h3>

<p>There is also a <a href="https://easystats.github.io/see/articles/bayestestR.html"><code>plot()</code>-method</a> implemented in the <a href="https://easystats.github.io/see/"><span class="pkg">see</span>-package</a>.
</p>


<h3>Author(s)</h3>

<p>Mattan S. Ben-Shachar
</p>


<h3>References</h3>


<ul>
<li><p> Gronau, Q. F., Wagenmakers, E. J., Heck, D. W., and Matzke, D. (2019). A simple method for comparing complex models: Bayesian model comparison for hierarchical multinomial processing tree models using Warp-III bridge sampling. Psychometrika, 84(1), 261-284.
</p>
</li>
<li><p> Kass, R. E., and Raftery, A. E. (1995). Bayes Factors. Journal of the American Statistical Association, 90(430), 773-795.
</p>
</li>
<li><p> Robert, C. P. (2016). The expected demise of the Bayes factor. Journal of Mathematical Psychology, 72, 33–37.
</p>
</li>
<li><p> Wagenmakers, E. J. (2007). A practical solution to the pervasive problems of p values. Psychonomic bulletin &amp; review, 14(5), 779-804.
</p>
</li>
<li><p> Wetzels, R., Matzke, D., Lee, M. D., Rouder, J. N., Iverson, G. J., and Wagenmakers, E.-J. (2011). Statistical Evidence in Experimental Psychology: An Empirical Comparison Using 855 t Tests. Perspectives on Psychological Science, 6(3), 291–298. doi: <a href="https://doi.org/10.1177/1745691611406923">10.1177/1745691611406923</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre>
# With lm objects:
# ----------------
lm1 &lt;- lm(Sepal.Length ~ 1, data = iris)
lm2 &lt;- lm(Sepal.Length ~ Species, data = iris)
lm3 &lt;- lm(Sepal.Length ~ Species + Petal.Length, data = iris)
lm4 &lt;- lm(Sepal.Length ~ Species * Petal.Length, data = iris)
bayesfactor_models(lm1, lm2, lm3, lm4, denominator = 1)
bayesfactor_models(lm2, lm3, lm4, denominator = lm1) # same result
bayesfactor_models(lm1, lm2, lm3, lm4, denominator = lm1) # same result

## Not run: 
# With lmerMod objects:
# ---------------------
if (require("lme4")) {
  lmer1 &lt;- lmer(Sepal.Length ~ Petal.Length + (1 | Species), data = iris)
  lmer2 &lt;- lmer(Sepal.Length ~ Petal.Length + (Petal.Length | Species), data = iris)
  lmer3 &lt;- lmer(
    Sepal.Length ~ Petal.Length + (Petal.Length | Species) + (1 | Petal.Width),
    data = iris
  )
  bayesfactor_models(lmer1, lmer2, lmer3, denominator = 1)
  bayesfactor_models(lmer1, lmer2, lmer3, denominator = lmer1)
}

# rstanarm models
# ---------------------
# (note that a unique diagnostic_file MUST be specified in order to work)
if (require("rstanarm")) {
  stan_m0 &lt;- stan_glm(Sepal.Length ~ 1,
    data = iris,
    family = gaussian(),
    diagnostic_file = file.path(tempdir(), "df0.csv")
  )
  stan_m1 &lt;- stan_glm(Sepal.Length ~ Species,
    data = iris,
    family = gaussian(),
    diagnostic_file = file.path(tempdir(), "df1.csv")
  )
  stan_m2 &lt;- stan_glm(Sepal.Length ~ Species + Petal.Length,
    data = iris,
    family = gaussian(),
    diagnostic_file = file.path(tempdir(), "df2.csv")
  )
  bayesfactor_models(stan_m1, stan_m2, denominator = stan_m0)
}


# brms models
# --------------------
# (note the save_all_pars MUST be set to TRUE in order to work)
if (require("brms")) {
  brm1 &lt;- brm(Sepal.Length ~ 1, data = iris, save_all_pars = TRUE)
  brm2 &lt;- brm(Sepal.Length ~ Species, data = iris, save_all_pars = TRUE)
  brm3 &lt;- brm(
    Sepal.Length ~ Species + Petal.Length,
    data = iris,
    save_all_pars = TRUE
  )

  bayesfactor_models(brm1, brm2, brm3, denominator = 1)
}


# BayesFactor
# ---------------------------
if (require("BayesFactor")) {
  data(puzzles)
  BF &lt;- anovaBF(RT ~ shape * color + ID,
    data = puzzles,
    whichRandom = "ID", progress = FALSE
  )
  BF
  bayesfactor_models(BF) # basically the same
}

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>bayestestR</em> version 0.7.0 <a href="00Index.html">Index</a>]</div>
</body></html>
